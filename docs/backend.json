{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile within the SunoBot application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "preferredLanguage": {
          "type": "string",
          "description": "User's preferred language (e.g., 'en', 'ur')."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "User's phone number."
        },
        "profilePictureUrl": {
          "type": "string",
          "description": "URL of the user's profile picture.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the user profile was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the user profile was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "preferredLanguage",
        "createdAt",
        "updatedAt"
      ]
    },
    "Settings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Settings",
      "type": "object",
      "description": "Represents user-specific settings for the SunoBot application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the settings entity."
        },
        "userProfileId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:1 Settings)"
        },
        "notificationsEnabled": {
          "type": "boolean",
          "description": "Indicates whether notifications are enabled for the user."
        },
        "voiceAssistantSpeed": {
          "type": "number",
          "description": "The preferred speech rate for the voice assistant."
        },
        "theme": {
          "type": "string",
          "description": "User's preferred theme (e.g., 'light', 'dark')."
        },
        "dataSavingMode": {
          "type": "boolean",
          "description": "Indicates whether data saving mode is enabled."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the settings were created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the settings were last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userProfileId",
        "notificationsEnabled",
        "voiceAssistantSpeed",
        "theme",
        "dataSavingMode",
        "createdAt",
        "updatedAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/profile",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information.  Accessible only by the user with the matching {userId}.",
          "params": [
            {
              "name": "userId",
              "description": "The unique ID of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/settings",
        "definition": {
          "entityName": "Settings",
          "schema": {
            "$ref": "#/backend/entities/Settings"
          },
          "description": "Stores user-specific settings.  Accessible only by the user with the matching {userId}.",
          "params": [
            {
              "name": "userId",
              "description": "The unique ID of the user."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore data structure is designed to support the SunoBot application, prioritizing security, scalability, and debuggability, especially given the target audience (elders, kids, rural users).  The structure leverages path-based ownership for user profiles and settings, ensuring data privacy. Authorization Independence is maintained by using path-based ownership, eliminating the need for `get()` calls in security rules. This enables atomic operations. Structural Segregation separates user-specific data into dedicated collections to enforce homogeneous security requirements. The design incorporates explicit state modeling where applicable and follows semantic naming conventions for clarity.\n\nSpecifically:\n\n*   `/users/{userId}/profile`:  Each user has their profile.  Access is restricted to the authenticated user.\n*   `/users/{userId}/settings`: Each user has their settings.  Access is restricted to the authenticated user."
  }
}